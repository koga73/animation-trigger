/*
* animation-trigger v1.0.0 Copyright (c) 2020 AJ Savino
* https://github.com/koga73/animation-trigger
* MIT License
*/
var AnimationTrigger=function(e){var _=null,u={attributeAnimTrig:AnimationTrigger.DEFAULT_ATTRIBUTE_ANIM_TRIG,events:!1,eventChangeVisible:AnimationTrigger.DEFAULT_EVENT_CHANGE_VISIBLE,eventChangeActive:AnimationTrigger.DEFAULT_EVENT_CHANGE_ACTIVE,classVisible:AnimationTrigger.DEFAULT_CLASS_VISIBLE,classShown:AnimationTrigger.DEFAULT_CLASS_SHOWN,classActive:AnimationTrigger.DEFAULT_CLASS_ACTIVE,classActivated:AnimationTrigger.DEFAULT_CLASS_ACTIVATED,scrollDebounce:200,_el:null,_animEls:[],_animElsBounds:[],_resizer:null,_scrollTimeout:0},v={init:function(e){e=e||document,u._el=e,"undefined"!=typeof Resizer&&(u._resizer=new Resizer({onResize:v._handler_resize})),_.updateEls(),_.evalVisibility(),_.evalActive()},destroy:function(){u._el.removeEventListener("scroll",v._handler_scroll),clearTimeout(u._scrollTimeout),u._resizer&&(u._resizer.destroy(),u._resizer=null),u._animElsBounds=[],u._animEls=[],u._el=null},getEls:function(){return u._animEls},getVisible:function(){return u._el.querySelectorAll("."+_.classVisible)},getShown:function(){return u._el.querySelectorAll("."+_.classShown)},getActive:function(){return u._el.querySelector("."+_.classActive)},getActivated:function(){return u._el.querySelector("."+_.classActivated)},updateEls:function(){if(u._animEls=u._el.querySelectorAll("["+_.attributeAnimTrig+"]"),u._animEls.length?u._el.addEventListener("scroll",v._handler_scroll):u._el.removeEventListener("scroll",v._handler_scroll),!u._resizer)return console.warn("Resizer excluded - cache disabled"),void(u._animElsBounds=null);u._animElsBounds=[];for(var e=0;e<u._animEls.length;e++){var i=u._animEls[e];u._animElsBounds.push(v._getBounds(i))}},_getBounds:function(e){return[e.offsetLeft,e.offsetTop,e.offsetLeft+e.clientWidth,e.offsetTop+e.clientHeight]},isVisible:function(e){var i,t=v._getScrollBounds(),s=-1;if(u._animElsBounds)for(var n=0;n<u._animEls.length;n++)if(u._animEls[n]==e){s=n;break}var l=(i=-1!=s?u._animElsBounds[s]:v._getBounds(e))[0]>=t[0]&&i[0]<=t[2]||i[2]>=t[0]&&i[2]<=t[2],a=i[1]>=t[1]&&i[1]<=t[3]||i[3]>=t[1]&&i[3]<=t[3];return l&&a},_handler_scroll:function(e){_.scrollDebounce?(u._scrollTimeout&&clearTimeout(u._scrollTimeout),u._scrollTimeout=setTimeout(v._handler_scroll_timeout,_.scrollDebounce)):v._handler_scroll_timeout()},_handler_scroll_timeout:function(){clearTimeout(u._scrollTimeout),_.evalVisibility(),_.evalActive()},_handler_resize:function(e,i){_.updateEls(),_.evalVisibility(),_.evalActive()},_getScrollBounds:function(){if(u._el!=document)return[u._el.scrollLeft,u._el.scrollTop,u._el.scrollLeft,u._el.scrollLeft];var e=document.body.scrollLeft||document.documentElement.scrollLeft,i=document.body.scrollTop||document.documentElement.scrollTop;return[e,i,e+window.innerWidth,i+window.innerHeight]},evalActive:function(){for(var e=v._getScrollBounds(),i=[e[0]+Math.abs(e[2]-e[0]),e[1]+Math.abs(e[3]-e[1])],t=-1,s=-1,n=0;n<u._animEls.length;n++){var l,a=u._animEls[n],r=[(l=u._animElsBounds?u._animElsBounds[n]:v._getBounds(a))[0]+Math.abs(l[2]-l[0]),l[1]+Math.abs(l[3]-l[1])],o=[Math.abs(i[0]-r[0]),Math.abs(i[1]-r[1])],c=Math.sqrt(Math.pow(o[0],2)+Math.pow(o[1],2));(-1==s||c<s)&&(s=c,t=n)}for(n=0;n<u._animEls.length;n++){a=u._animEls[n];n==t?a.classList.contains(_.classActive)||(a.classList.add(_.classActive),a.classList.contains(_.classActivated)||a.classList.add(_.classActivated),_.events&&a.dispatchEvent(new CustomEvent(_.eventChangeActive,{detail:{isActive:!0}}))):a.classList.contains(_.classActive)&&(a.classList.remove(_.classActive),_.events&&a.dispatchEvent(new CustomEvent(_.eventChangeActive,{detail:{isActive:!1}})))}},evalVisibility:function(){for(var e=[],i=[],t=0;t<u._animEls.length;t++){var s=u._animEls[t];_.isVisible(s)?(s.classList.contains(_.classVisible)||(s.classList.add(_.classVisible),s.classList.contains(_.classShown)||s.classList.add(_.classShown),e.push({el:s,isVisible:!0})),i.push(s)):s.classList.contains(_.classVisible)&&(s.classList.remove(_.classVisible),e.push({el:s,isVisible:!1}))}if(_.events)for(t=0;t<e.length;t++){var n=e[t];n.el.dispatchEvent(new CustomEvent(_.eventChangeVisible,{detail:{isVisible:n.isVisible}}))}}};_={attributeAnimTrig:u.attributeAnimTrig,events:u.events,eventChangeVisible:u.eventChangeVisible,eventChangeActive:u.eventChangeActive,classVisible:u.classVisible,classShown:u.classShown,classActive:u.classActive,classActivated:u.classActivated,scrollDebounce:u.scrollDebounce,init:v.init,destroy:v.destroy,getEls:v.getEls,getVisible:v.getVisible,getShown:v.getShown,getActive:v.getActive,getActivated:v.getActivated,updateEls:v.updateEls,isVisible:v.isVisible,evalVisibility:v.evalVisibility,evalActive:v.evalActive};var i=null;if(e){for(var t in e)_[t]=e[t];i=t.el||null}return _.init(i),_};AnimationTrigger.DEFAULT_ATTRIBUTE_ANIM_TRIG="data-animation-trigger",AnimationTrigger.DEFAULT_EVENT_CHANGE_VISIBLE="animation-trigger-event-visible",AnimationTrigger.DEFAULT_EVENT_CHANGE_ACTIVE="animation-trigger-event-active",AnimationTrigger.DEFAULT_CLASS_VISIBLE="animation-trigger-visible",AnimationTrigger.DEFAULT_CLASS_SHOWN="animation-trigger-shown",AnimationTrigger.DEFAULT_CLASS_ACTIVE="animation-trigger-active",AnimationTrigger.DEFAULT_CLASS_ACTIVATED="animation-trigger-activated",window.AnimationTrigger=AnimationTrigger;